[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=5e874c5e-f969-471a-861b-ee77a35692a3
Description=短剧搜索神器
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
// 群文件下载插件：SmHTTP.dll
// 将插件放到按键精灵根目录下的 plugin 目录下


Global Global_result

Function 展示搜索结果()
    length = Plugin.SmHTTP.GetJSON(Global_result, "data.length")
    set JSON = Plugin.SmHTTP.JSON_toObject(Global_result)
    For i = 1 To length
    	Form1.Grid1.InsertRow Form1.Grid1.RowCount
    	Form1.Grid1.SetCellType i, 0, 0
    	Form1.Grid1.SetCellType i, 1, 3
    	Form1.Grid1.SetCellType i, 2, 5
    	
    	name = JSON("data")(i)("name")
    	addtime = JSON("data")(i)("addtime")
    	viewlink = JSON("data")(i)("viewlink")
    	Form1.Grid1.SetItemText i,0,name 
    	Form1.Grid1.SetItemText i,1,addtime
    	Form1.Grid1.SetItemText i, 2, viewlink
    	Form1.ProgressBar1.Value = 100 / length * i 
    Next
    Set JSON = Nothing 
End Function




Event Form1.Button1.Click
	关键词 = Form1.InputBox1.Text
	返回值 = Plugin.SmHTTP.HTTP_GET("https://zy.6789o.com/duanjuapi/search.php?text=" & 关键词)
	code = Plugin.SmHTTP.GetJSON(返回值, "code")
	If code = 200 Then 
		Global_result = 返回值
		BeginThread 展示搜索结果
	Else 
		MsgBox "出错，搜索失败！" & vbCrLf & vbCrLf & 返回值, 16 + 4096, "报错！"
	End If
End Event
