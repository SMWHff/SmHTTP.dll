<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>JsonData</title>
    <script type="text/javascript" src="../../JS/shCore.js"></script>
    <link rel="stylesheet" type="text/css" href="../../CSS/SyntaxHighlighter.css">
    <link rel="stylesheet" type="text/css" href="../../CSS/help.css">
    <style>
    body{font-size:12px; font-family:Verdana,"宋体"}
    .ts{ background:#fff; margin:0 0 40px 0;}
    .ts th{ color:#7B797B; background:#DEDFDE; line-height:24px;}
    .ts td {padding:6px 0;}
    .name { font-size:16px; font-weight:bold; border-top:1px dashed #9C9A9C; border-bottom:1px dashed #9C9A9C; color:#006939;}
    .canshu { background:#E7E7EF;}
    .red{ color:#d60000;}
    .blue{ color:#0000FF;}
    .green{ color:#006939;}
    .fanhui{ border-bottom:1px dashed #9C9A9C;}
    .lizi{ border-bottom:1px dashed #9C9A9C;}
    /* Language specific styles */
    /*
      comment 为注释代码着色
      comments 为块注释代码着色
      string  为字符串文字着色
      keyword 为关键字着色
      preprocessor 自定义规则着色
    */
    .dp-highlighter .comment, .dp-highlighter .comments { color: darkgreen; background-color: inherit; }
    .dp-highlighter .string { color: darkgray; background-color: inherit; }
    .dp-highlighter .keyword { color: #0000FF; font-weight: bold; background-color: inherit; }
    .dp-highlighter .preprocessor { color: #FF00FF; background-color: inherit; }
    </style>
</head>
<body>	



<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='JsonData'></a>JsonData 构造JSON主体
</td></tr><tr><th>命令功能：</th><td>
构造JSON主体
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1、2【必选】：（文本型）键名1、（任意型）键值1
参数3、4【可选】：（文本型）键名2、（任意型）键值2
参数5、6【可选】：（文本型）键名3、（任意型）键值3
……
</td></tr><tr><th>返回值：</th><td class='fanhui'>
文本型，JSON主体
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_JsonData" class="vb" id="code8_JsonData">
Dim JsonData

' 构造 JSON 主体（简单）
JsonData = SmHTTP.JsonData( _
    "empty", Empty, _
    "null", Null, _
    "int", 123, _
    "float", 3.14, _
    "bool", CBool(True), _
    "str", "神梦无痕""1042207232""", _
    "array", Array(1, 3.14, CBool(True), Null, "按键精灵") _
)
TracePrint JsonData


' 构造 JSON 主体（中等）
JsonData = SmHTTP.JsonData( _
    "header", SmHTTP.JsonData( _
        "fn", "auto_translation" _
    ), _
    "type", "plain", _
    "model_category", "normal", _
    "text_domain", "general", _
    "source", SmHTTP.JsonData( _
        "lang", "auto", _
        "text_list", Array("My cat likes eating fish.") _
    ), _
    "target", SmHTTP.JsonData( _
        "lang", "zh" _
    ) _
)
TracePrint JsonData


' 构造 JSON 主体（复杂）
JsonData = SmHTTP.JsonData( _
    "jsonrpc", "2.0", _
    "method", "LMT_handle_jobs", _
    "params", SmHTTP.JsonData( _
        "jobs", "[" & _
    		SmHTTP.JsonData( _
        		"kind", "default", _
        		"sentences", "[" & _
            		SmHTTP.JsonData( _
                		"text", enStr, _
                		"id", 1, _
                		"prefix", "" _
            		) & _
        		"]", _
        		"raw_en_context_before", Array(), _
        		"raw_en_context_after", Array(), _
        		"preferred_num_beams", 4 _
    		) & _
		"]", _
        "lang", SmHTTP.JsonData( _
    		"target_lang", lang, _
    		"preference", SmHTTP.JsonData( _
        		"weight", SmHTTP.JsonData( _
            		"DE", 0.18427, _
            		"EN", 9.93878, _
            		"ES", 0.13236, "FR", 0.16311, "IT", 0.11621, "JA", 0.17963, _
                    "NL", 0.1865, "PL", 0.11549, "PT", 0.10159, "RU", 0.10577, _
            		"ZH", 5.90582, _
            		"BG", 0.07468, "CS", 0.09005, "DA", 0.08567, "EL", 0.07069, _
                    "ET", 0.0836, "FI", 0.09628, "HU", 0.08731, "LT", 0.07119, _
            		"LV", 0.06866, "RO", 0.07842, "SK", 0.07497, "SL", 0.08492, _
                    "SV", 0.10275, "TR", 0.07728, "ID", 0.09161, "UK", 0.08573, _
                    "KO", 0.04671, "NB", 0.05511 _
        		), _
        		"default", "default" _
    		), _
    		"source_lang_user_selected", from _
		), _
        "priority", 1, _
        "commonJobParams", SmHTTP.JsonData( _
            "mode", "translate", _
            "textType", "plaintext", _
            "browserType", 1 _
        ), _
        "timestamp", timestamp _
    ), _
    "id", deepl_id _
)
TracePrint JsonData
</td></tr></table>	
	
	


<script type="text/javascript">
    dp.sh.Brushes.Vb = function()
    { 
        var keywords = 'vbBlack vbRed vbGreen vbYellow vbBlue vbMagenta vbCyan vbWhite vbBinaryCompare vbTextCompare vbSunday vbMonday vbTuesday vbWednesday ' + 
        'vbThursday vbFriday vbSaturday vbUseSystemDayOfWeek vbFirstJan1 vbFirstFourDays vbFirstFullWeek vbGeneralDate vbLongDate vbShortDate vbLongTime ' + 
        'vbShortTime vbObjectError vbOKOnly vbOKCancel vbAbortRetryIgnore vbYesNoCancel vbYesNo vbRetryCancel vbCritical vbQuestion vbExclamation vbInformation ' + 
        'vbDefaultButton1 vbDefaultButton2 vbDefaultButton3 vbDefaultButton4 vbApplicationModal vbSystemModal vbOK vbCancel vbAbort vbRetry vbIgnore vbYes vbNo '+
        'vbCr vbCrLf vbFormFeed vbLf vbNewLine vbNullChar vbNullString vbTab vbVerticalTab vbUseDefault vbTrue vbFalse vbEmpty vbNull vbInteger vbLong vbSingle '+
        'vbDouble vbCurrency vbDate vbString vbObject vbError vbBoolean vbVariant vbDataObject vbDecimal vbByte vbArray WScript '+
        'And As Boolean ByRef Byte ByVal Call Case Const Currency Debug Dim Do Double Each Else ElseIf Empty End EndIf Enum Eqv Event Exit Explicit False For '+ 
        'Function Get Goto If Imp Implements In Integer Is Let Like Long Loop LSet Me Mod New Next Not Nothing Null On Option Optional Or ParamArray Preserve '+
        'Private Property Public RaiseEvent ReDim Rem Resume RSet Select Set Shared Single Static Stop Sub Then To True Type TypeOf Until Variant Wend While With '+
        'Xor IfColor Import UserVar SetSimMode Global EndScript ExitScript RestartScript Delay VBSBegin VBSEnd Lib LibE Alias Declare Plugin ' +
        'Abs Array Asc Atn CBool CByte CCur CDate CDbl CInt CLng CSng CStr Chr Cos CreateObject Date DateAdd DateDiff DatePart DateSerial DateValue Day Escape '+
        'Eval Exp Filter Fix FormatCurrency FormatDateTime FormatNumber FormatPercent GetLocale GetObject GetRef Hex Hour InStr InStrRev InputBox Int IsArray '+
        'IsDate IsEmpty IsNull IsNumeric IsObject Join LBound LCase LTrim Left Len LoadPicture Log Mid Minute Month MonthName MsgBox Now Oct Randomize RGB RTrim '+
        'Replace Right Rnd Round ScriptEngine ScriptEngineBuildVersion ScriptEngineMajorVersion ScriptEngineMinorVersion Second SetLocale Sgn Sin Space Split Sqr '+
        'StrComp StrReverse String Tan Time TimeSerial TimeValue Timer Trim TypeName UBound UCase Unescape VarType Weekday WeekdayName Year KeyGroup KeyPress '+
        'KeyPressH KeyPressS KeyDown KeyDownH KeyDownS KeyUp KeyUpH KeyUpS WaitKey GetLastKey LeftClick LeftClickH LeftClickS LeftDoubleClick LeftDoubleClickH '+
        'LeftDoubleClickS LeftDown LeftDownH LeftDownS LeftUp LeftUpH LeftUpS RightClick RightClickH RightClickS RightDown RightDownH RightDownS RightUp '+
        'RightUpH RightUpS MiddleClick MiddleClickH MiddleClickS MoveTo MoveToH MoveToS MoveR MoveRH MoveRS MouseWheel SaveMousePos RestoreMousePos LockMouse '+
        'UnlockMouse WaitClick GetLastClick GetCursorPos GetCursorShape GetPixelColor FindColor FindColorEx FindCenterColor FindPic GetMacroID SayString '+
        'MessageBox RunApp PutAttachment TracePrint LogStart LogStop BeginThread StopThread PauseThread ContinueThread GetThreadID SetEnv GetEnv Beep Execute '+
        'GetExeDir GetScreenResolution ExecuteGlobal QMLibrary QUIMethodObj '+
        'Access Bkgnd BkgndColor Color Console Encrypt File GetSysInfo Media Memory Msg MySql Net Office Oracle Pic SQLServer Sys Web Window '+
        'sm SMWH SMWH_ff SmIE SmADO SmVM SmWeb SmReg SmOCR SmAssert SmPrint SmHTTP SGuoBrowser TURING';
        this.regexList = [
            { regex: new RegExp('(//|\').*$', 'gm'), css: 'comment' }, 
            { regex: new RegExp('/\\*([\\s\\S]*?)\\*/', 'gm'), css: 'comments' }, 
            { regex: dp.sh.RegexLib.DoubleQuotedString, css: 'string' }, 
            { regex: new RegExp(this.GetKeywords('dm'), 'gm'), css: 'preprocessor' }, 
            { regex: new RegExp(this.GetKeywords(keywords), 'gm'), css: 'keyword'}
        ]; 
        this.CssClass = 'dp-vb'; 
    }
    dp.sh.Brushes.Vb.prototype = new dp.sh.Highlighter(); dp.sh.Brushes.Vb.Aliases = ['vb', 'vb.net'];
    dp.SyntaxHighlighter.HighlightAll('code8_JsonData',true,true,false);

</script>
</body>
</html>	

